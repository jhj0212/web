<!--
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Menu</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link href="__PUBLIC__/Admin/Styles/general.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="__PUBLIC__/Admin/css/pintuer.css">
    <link rel="stylesheet" href="__PUBLIC__/Admin/css/admin.css">
    <link rel="stylesheet" href="__PUBLIC__/Admin/css/menu.css">



</head>
<body style="background-color:#f2f9fd;">

<div id="tabbar-div">
    <div class="leftnav-title">
        <strong>
            <span class="tab-front icon-list"></span>菜单列表

            <a href="javascript:toggleCollapse();" style="">
                <img id="toggleImg" src="__PUBLIC__/Admin/img/menu_minus.gif" width="9" height="9" border="0" alt="闭合" />
            </a>
        </strong>
    </div>


    <div id="menu-list">
        <ul id="menu-ul">
            <?php foreach ($btn as $k => $v): ?>
            <li class="explode" key="02_cat_and_goods" name="menu">
                {$v.pri_name}
                <ul>
                    <?php foreach ($v['children'] as $k1 => $v1): ?>
                    <li class="menu-item"><a href="<?php echo U($v1['pri_url']); ?>" class="main-frame" target=" right">{$v1.pri_name}</a></li>
                    <?php endforeach; ?>
                </ul>
            </li>
            <?php endforeach; ?>
        </ul>
    </div>
    <div id="help-div" style="display:none">
        <h1 id="help-title"></h1>
        <div id="help-content"></div>
    </div>
</div>
<script type="text/javascript" src="__PUBLIC__/Admin/Js/global.js"></script>
<script type="text/javascript" src="__PUBLIC__/Admin/Js/utils.js"></script>
<script type="text/javascript" src="__PUBLIC__/Admin/Js/transport.js"></script>
<script language="JavaScript">
    var collapse_all = "闭合";
    var expand_all = "展开";
    var collapse = true;

    function toggleCollapse() {
        var items = document.getElementsByTagName('LI');
        for(i = 0; i < items.length; i++) {
            if(collapse) {
                if (items[i].className == "explode") {
                    toggleCollapseExpand(items[i],"collapse");
                }
            } else {
                if(items[i].className == "collapse") {
                    toggleCollapseExpand(items[i],"explode");
                    ToggleHanlder.Reset();
                }
            }
        }
        collapse = !collapse;
        document.getElementById('toggleImg').src = collapse ? '__PUBLIC__/Admin/img/menu_minus.gif' : '__PUBLIC__/Admin/img/menu_plus.gif';
        document.getElementById('toggleImg').alt = collapse ? collapse_all : expand_all;
    }

    function toggleCollapseExpand(obj, status) {
        if (obj.tagName.toLowerCase() == 'li' && obj.className != 'menu-item') {
            for (i = 0; i < obj.childNodes.length; i++) {
                if (obj.childNodes[i].tagName == "UL") {
                    if (status == null) {
                        if (obj.childNodes[1].style.display != "none") {
                            obj.childNodes[1].style.display = "none";
                            ToggleHanlder.RecordState(obj.getAttribute("key"),"collapse");
                            obj.className = "collapse";
                        } else {
                            obj.childNodes[1].style.display = "block";
                            ToggleHanlder.RecordState(obj.getAttribute("key"),"explode");
                            obj.className = "explode";
                        }
                        break;
                    } else {
                        if(status == "collapse") {
                            ToggleHanlder.RecordState(obj.getAttribute("key"),"collapse");
                            obj.className = "collapse";
                        } else {
                            ToggleHanlder.RecordState(obj.getAttribute("key"),"explode");
                            obj.className = "explode";
                        }
                        obj.childNodes[1].style.display = (status == "explode") ? "block" : "none";
                    }
                }
            }
        }
    }

    document.getElementById('menu-list').onclick = function(e) {
        var obj = Utils.srcElement(e);
        toggleCollapseExpand(obj);
    }

    document.getElementById('tabbar-div').onmouseover = function(e) {
        var obj = Utils.srcElement(e);
        if (obj.className == "tab-back") {
            obj.className = "tab-hover";
        }
    }

    document.getElementById('tabbar-div').onmouseout = function(e) {
        var obj = Utils.srcElement(e);
        if (obj.className == "tab-hover") {
            obj.className = "tab-back";
        }
    }

    document.getElementById('tabbar-div').onclick = function(e) {
        var obj = Utils.srcElement(e);
        var hlpTab = document.getElementById('help-tab');
        var mnuDiv = document.getElementById('menu-list');
        var hlpDiv = document.getElementById('help-div');

        if (obj.id == 'help-tab') {
            mnuTab.className = 'tab-back';
            hlpTab.className = 'tab-front';
            mnuDiv.style.display = "none";
            hlpDiv.style.display = "block";

            loc = parent.frames['main-frame'].location.href;
            pos1 = loc.lastIndexOf("/");
            pos2 = loc.lastIndexOf("?");
            pos3 = loc.indexOf("act=");
            pos4 = loc.indexOf("&",pos3);

            filename = loc.substring(pos1 + 1, pos2 - 4);
            act = pos4 < 0 ? loc.substring(pos3 + 4) : loc.substring(pos3 + 4,pos4);
            loadHelp(filename,act);
        }
    }

    //菜单展合状态处理器
    var ToggleHanlder = new Object();

    Object.extend(
        ToggleHanlder ,{
            SourceObject : new Object(),
            CookieName   : 'Toggle_State',
            RecordState : function(name,state){
                if(state == "collapse") {
                    this.SourceObject[name] = state;
                } else {
                    if(this.SourceObject[name]) {
                        delete(this.SourceObject[name]);
                    }
                }
                var date = new Date();
                date.setTime(date.getTime() + 99999999);
                document.setCookie(this.CookieName, this.SourceObject.toJSONString(),date.toGMTString());
            },

            Reset :function() {
                var date = new Date();
                date.setTime(date.getTime() + 99999999);
                document.setCookie(this.CookieName,"{}",date.toGMTString());
            },

            Load : function() {
                if(document.getCookie(this.CookieName) != null) {
                    this.SourceObject = eval("("+ document.getCookie(this.CookieName) +")");
                    var items = document.getElementsByTagName('LI');
                    for(var i = 0; i < items.length; i++) {
                        if( items[0].getAttribute("name") == "menu" && items[0].getAttribute("id") != '20_yun') {
                            for(var k in this.SourceObject) {
                                if(typeof(items[i]) == "object") {
                                    if(items[i].getAttribute('key') == k) {
                                        toggleCollapseExpand(items[i], this.SourceObject[k]);
                                        collapse = false;
                                    }
                                }
                            }
                        }
                    }
                }
                document.getElementById('toggleImg').src = collapse ? '__PUBLIC__/Admin/img/menu_minus.gif' : '__PUBLIC__/Admin/img/menu_plus.gif';
                document.getElementById('toggleImg').alt = collapse ? collapse_all : expand_all;
            }
        }
    );

</script>

</body>
</html>-->
